var vuethers=function(a,E,e){"use strict";const q={class:"ConnectWalletButton"},K={key:1,disabled:""},Z={key:2,disabled:""},z={key:3,disabled:""},Q={key:4,disabled:""},X={__name:"ConnectWalletButton",setup(r){return(t,n)=>{const s=e.resolveComponent("OnProviderSafe");return e.openBlock(),e.createBlock(s,null,{default:e.withCtx(()=>[e.createElementVNode("div",q,[e.unref(a.dapp).signer.status.is("DISCONNECTED")?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:n[0]||(n[0]=(...o)=>e.unref(C)&&e.unref(C)(...o))},"Connect Wallet")):e.unref(a.dapp).signer.status.is("REQUESTED")?(e.openBlock(),e.createElementBlock("button",K,"Connection requested...")):e.unref(a.dapp).signer.status.is("REFUSED")?(e.openBlock(),e.createElementBlock("button",Z,"Connection refused!")):e.unref(a.dapp).signer.status.is("ERROR")?(e.openBlock(),e.createElementBlock("button",z,"Connection error!")):e.unref(a.dapp).provider.status.is("WRONG")?(e.openBlock(),e.createElementBlock("button",Q,"Wrong network! ("+e.toDisplayString(e.unref(a.dapp).networks.current.displayName)+")",1)):e.unref(a.dapp).signer.status.is("CONNECTED")?(e.openBlock(),e.createElementBlock("button",{key:5,onClick:n[1]||(n[1]=(...o)=>e.unref(w)&&e.unref(w)(...o))},"Disconnect")):e.createCommentVNode("",!0)])]),_:1})}}},Y=e.createTextVNode("Functions : "),J=["onClick"],x=e.createElementVNode("br",null,null,-1),ee={key:0},te=e.createElementVNode("small",null,"Inputs :",-1),ne=["onUpdate:modelValue","type","placeholder"],ae={key:0},se=["onUpdate:modelValue"],re=["onUpdate:modelValue"],oe=["value"],ie={key:1},ce=e.createElementVNode("small",null,"Outputs :",-1),le=["onUpdate:modelValue","placeholder"],de={key:2},pe=e.createTextVNode(" Events : "),he=e.createElementVNode("p",null,"Logs:",-1),ue={__name:"ContractInteractor",props:{contract:{type:String,required:!0}},setup(r){const t=r;async function n(i){const d=[];for(const b of y.value[i].inputs)d.push(b.value);const _={};y.value[i].payable&&y.value[i].tx.value.value!==""&&(_.value=E.ethers.utils.parseUnits(y.value[i].tx.value.value,y.value[i].tx.value.unit));const m=new D(u.value.functions[i]);m.send(d,_),m.call.then(b=>{for(let p=0;p<b.length;p++)y.value[i].outputs[p].value=b[p]}).catch(b=>{y.value[i].error=b.reason})}async function s(i){N.value[i.event].count+=1;let d=`Block ${i.blockNumber} -> {`;for(const _ of N.value[i.event].inputs)d+=`${_.name}:${i.args[_.name]}, `;d=d.substring(0,d.length-2)+"}",N.value[i.event].logs.push(d)}function o(i){return i.includes("int")?"number":"text"}function c(i){return`${i.name&&i.name!=="null"?i.name:"unnamed"} (${i.type})`}function l(i){const d=[];return d.push(i.mutability),i.payable&&d.push("payable"),d.join(", ")}const h=t.contract,u=e.computed(()=>a.dapp.contracts[t.contract]);let f=e.ref("no owner");const v=["wei","gwei","ether"],N=e.ref({}),y=e.ref({});return a.dapp.contracts.onReadSafe(async function(){try{f.value=await u.value.owner()}catch{}for(const i of Object.values(u.value.interface.functions)){y.value[i.name]={inputs:[],outputs:[],error:null,payable:i.payable,mutability:i.stateMutability==="view"||i.stateMutability==="pure"?"read":"write",tx:{value:{value:"",unit:"wei"}}};for(let d=0;d<i.inputs.length;d++)y.value[i.name].inputs[d]={name:i.inputs[d].name,type:i.inputs[d].type,value:""};for(let d=0;d<i.outputs.length;d++)y.value[i.name].outputs[d]={name:i.outputs[d].name,type:i.outputs[d].type,value:""}}for(const i of Object.values(u.value.interface.events))N.value[i.name]={count:0,logs:[],inputs:i.inputs},u.value.on(i,s)}),(i,d)=>{const _=e.resolveComponent("OnContractsReadSafe");return e.openBlock(),e.createBlock(_,null,{default:e.withCtx(()=>[u.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",null,"Interact with '"+e.toDisplayString(e.unref(h))+"' contract :",1),e.createElementVNode("ul",null,[e.createElementVNode("li",null,"Address : "+e.toDisplayString(u.value.address),1),e.createElementVNode("li",null,"Owner : "+e.toDisplayString(f.value),1),e.createElementVNode("li",null,[Y,e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value,(m,b)=>(e.openBlock(),e.createElementBlock("li",null,[e.createElementVNode("button",{onClick:p=>n(b)},e.toDisplayString(b),9,J),e.createElementVNode("small",null,"("+e.toDisplayString(l(m))+")",1),x,Object.keys(m.inputs).length>0||m.payable?(e.openBlock(),e.createElementBlock("div",ee,[te,e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.inputs,(p,ve)=>(e.openBlock(),e.createElementBlock("li",null,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":B=>p.value=B,type:o(p.type),placeholder:c(p)},null,8,ne),[[e.vModelDynamic,p.value]])]))),256)),m.payable?(e.openBlock(),e.createElementBlock("li",ae,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":p=>m.tx.value.value=p,type:"text",placeholder:"TX value"},null,8,se),[[e.vModelText,m.tx.value.value]]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":p=>m.tx.value.unit=p},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(v,p=>e.createElementVNode("option",{value:p},e.toDisplayString(p),9,oe)),64))],8,re),[[e.vModelSelect,m.tx.value.unit]])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0),Object.keys(m.outputs).length>0?(e.openBlock(),e.createElementBlock("div",ie,[ce,e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.outputs,(p,ve)=>(e.openBlock(),e.createElementBlock("li",null,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":B=>p.value=B,type:"text",placeholder:c(p),disabled:""},null,8,le),[[e.vModelText,p.value]])]))),256))])])):e.createCommentVNode("",!0),m.error?(e.openBlock(),e.createElementBlock("p",de,e.toDisplayString(m.error),1)):e.createCommentVNode("",!0)]))),256))])]),e.createElementVNode("li",null,[pe,e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(N.value,(m,b)=>(e.openBlock(),e.createElementBlock("li",null,[e.createElementVNode("h3",null,e.toDisplayString(b),1),e.createElementVNode("p",null,"Count : "+e.toDisplayString(m.count),1),he,e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.logs,p=>(e.openBlock(),e.createElementBlock("li",null,e.toDisplayString(p),1))),256))])]))),256))])])])],64)):e.createCommentVNode("",!0)]),_:1})}}},me={class:"SelectNetworkDropdown"},fe={key:0,selected:""},ye=["src","alt"],be=["onClick"],Ee=["src","alt"],ge={__name:"SelectNetworkDropdown",setup(r){let t=e.ref({}),n=e.ref([]);a.dapp.onSafe(async function(){t.value=await a.dapp.config.providers.getCurrent(),n.value=await a.dapp.config.providers.getAvailable()});async function s(l){const h=n.value.find(u=>u.chainId===parseInt(l));if(h){l=E.ethers.utils.hexlify(parseInt(l)).toString(),l=E.ethers.utils.hexValue(l);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:l}]})}catch(u){u.code===4902&&await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:l,rpcUrls:[h.defaultRPC],chainName:h.name,nativeCurrency:{name:h.currency.symbol,symbol:h.currency.symbol,decimals:h.currency.decimals},blockExplorerUrls:h.explorer&&h.explorer.url!==""?[h.explorer.url]:null}]})}}}function o(){c.value=!c.value}let c=e.ref(!1);return(l,h)=>{const u=e.resolveComponent("OnDappSafe");return e.openBlock(),e.createBlock(u,null,{default:e.withCtx(()=>[e.createElementVNode("div",me,[e.createElementVNode("ul",{onClick:o},[t.value?(e.openBlock(),e.createElementBlock("li",fe,[e.createElementVNode("img",{width:"40",src:t.value.icon?t.value.icon:e.unref(a.dapp).config.defaults.providers.icon,alt:t.value.name+" logo"},null,8,ye),e.createElementVNode("p",null,e.toDisplayString(t.value.displayName),1)])):e.createCommentVNode("",!0),c.value?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.value,f=>(e.openBlock(),e.createElementBlock("li",{key:f.chainId,onClick:v=>s(f.chainId)},[e.createElementVNode("img",{width:"40",src:f.icon?f.icon:e.unref(a.dapp).config.defaults.providers.icon,alt:f.name+" logo"},null,8,Ee),e.createElementVNode("p",null,e.toDisplayString(f.displayName),1)],8,be))),128)):e.createCommentVNode("",!0)])])]),_:1})}}},qe="",_e=(r,t)=>{const n=r.__vccOpts||r;for(const[s,o]of t)n[s]=o;return n},P=r=>(e.pushScopeId("data-v-9c1aef71"),r=r(),e.popScopeId(),r),Se=P(()=>e.createElementVNode("h3",null,"Safe Runners",-1)),ke=P(()=>e.createElementVNode("h3",null,"Status",-1)),Ne=_e({__name:"DebugBar",setup(r){return(t,n)=>{const s=e.resolveComponent("OnDappSafe");return e.openBlock(),e.createBlock(s,null,{default:e.withCtx(()=>[e.createElementVNode("section",null,[e.createElementVNode("div",null,[Se,e.createElementVNode("ul",null,[e.createElementVNode("li",null,"DApp safe : "+e.toDisplayString(e.unref(a.dapp).isSafe),1),e.createElementVNode("li",null,"Network safe : "+e.toDisplayString(e.unref(a.dapp).provider.isSafe),1),e.createElementVNode("li",null,"Wallet safe : "+e.toDisplayString(e.unref(a.dapp).signer.isSafe),1),e.createElementVNode("li",null,"Contracts read safe : "+e.toDisplayString(e.unref(a.dapp).contracts.areReadSafe),1),e.createElementVNode("li",null,"Contracts write safe : "+e.toDisplayString(e.unref(a.dapp).contracts.areWriteSafe),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a.dapp).contracts.getAll(),(o,c)=>(e.openBlock(),e.createElementBlock("li",null,[e.createTextVNode(" contract "+e.toDisplayString(c)+" : ",1),e.createElementVNode("ul",null,[e.createElementVNode("li",null,"read safe : "+e.toDisplayString(o.isReadSafe),1),e.createElementVNode("li",null,"write safe : "+e.toDisplayString(o.isWriteSafe),1)])]))),256))])]),e.createElementVNode("div",null,[ke,e.createElementVNode("ul",null,[e.createElementVNode("li",null,"dapp : "+e.toDisplayString(e.unref(a.dapp).status.get()),1),e.createElementVNode("li",null,"provider : "+e.toDisplayString(e.unref(a.dapp).provider.status.get()),1),e.createElementVNode("li",null,"signer : "+e.toDisplayString(e.unref(a.dapp).signer.status.get()),1),e.createElementVNode("li",null,"contracts : "+e.toDisplayString(e.unref(a.dapp).contracts.status.get()),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a.dapp).contracts.getAll(),(o,c)=>(e.openBlock(),e.createElementBlock("li",null," contract "+e.toDisplayString(c)+" : "+e.toDisplayString(o.status.get()),1))),256))])])])]),_:1})}}},[["__scopeId","data-v-9c1aef71"]]),Ce={key:1,disabled:""},Oe={key:2,disabled:""},we={key:3,disabled:""},Re={key:4},Ie={__name:"Transact",props:{content:{type:String,required:!1},contract:{type:String,required:!0},action:{type:String,required:!0},args:{type:Array,required:!1},txArgs:{type:Object,required:!1}},setup(r){const t=r;let n=new D(null);a.dapp.contracts.onReadSafe(()=>{try{n.func=a.dapp.contracts[t.contract][t.action]}catch(o){throw console.log(o),`Error in Transact component : contract '${t.contract}' doesn't exist or it doesn't have any property '${t.action}'`}});function s(){const o=t.args?t.args:[],c=t.txArgs?t.txArgs:{};console.log(o),console.log(c),console.log(n),n.send(o,c)}return(o,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(n).status.is("UNSENT")?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:s},e.toDisplayString(t.content?t.content:"Transact"),1)):e.unref(n).status.is("SENT")?(e.openBlock(),e.createElementBlock("button",Ce,"Transaction sent...")):e.unref(n).status.is("ERROR")?(e.openBlock(),e.createElementBlock("button",Oe,"Transaction error!")):e.unref(n).status.is("SUCCESS")?(e.openBlock(),e.createElementBlock("button",we,"Success !")):e.createCommentVNode("",!0),e.unref(n).status.is("ERROR")?(e.openBlock(),e.createElementBlock("p",Re,e.toDisplayString(e.unref(n).error.reason),1)):e.createCommentVNode("",!0)],64))}},V={__name:"OnDappSafe",setup(r){return(t,n)=>e.unref(a.dapp).isSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(t.$slots,"default"),e.renderSlot(t.$slots,"safe")],64)):e.renderSlot(t.$slots,"unsafe",{key:1})}},T={__name:"OnProviderSafe",setup(r){return(t,n)=>e.unref(a.dapp).provider.isSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(t.$slots,"default"),e.renderSlot(t.$slots,"safe")],64)):e.renderSlot(t.$slots,"unsafe",{key:1})}},$={__name:"OnSignerSafe",setup(r){return(t,n)=>e.unref(a.dapp).signer.isSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(t.$slots,"default"),e.renderSlot(t.$slots,"safe")],64)):e.renderSlot(t.$slots,"unsafe",{key:1})}},j={__name:"OnContractsReadSafe",setup(r){return(t,n)=>e.unref(a.dapp).contracts.areReadSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(t.$slots,"default"),e.renderSlot(t.$slots,"safe")],64)):e.renderSlot(t.$slots,"unsafe",{key:1})}},A={__name:"OnContractsWriteSafe",setup(r){return(t,n)=>e.unref(a.dapp).contracts.areWriteSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(t.$slots,"default"),e.renderSlot(t.$slots,"safe")],64)):e.renderSlot(t.$slots,"unsafe",{key:1})}},W={__name:"OnContractReadSafe",props:{contract:{type:String,required:!0}},setup(r){const t=r;return(n,s)=>e.unref(a.dapp).contracts[t.contract].isReadSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(n.$slots,"default"),e.renderSlot(n.$slots,"safe")],64)):e.renderSlot(n.$slots,"unsafe",{key:1})}},U={__name:"OnContractWriteSafe",props:{contract:{type:String,required:!0}},setup(r){const t=r;return(n,s)=>e.unref(a.dapp).contracts[t.contract].isWriteSafe.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(n.$slots,"default"),e.renderSlot(n.$slots,"safe")],64)):e.renderSlot(n.$slots,"unsafe",{key:1})}};class g{constructor(t,n){if(this._name=t,this.states=[],!Array.isArray(n))throw`The 'states' parameter of a Status instance '${t}' must an array of strings. Got: ${n}`;for(const s of n)this.states.push(this._formatState(s));this._state=e.ref(this.states[0])}_formatState(t){return t.toString().toUpperCase()}_isStateValid(t){return!!this.states.includes(this._formatState(t))}_areStatesValid(t){for(const n of t)if(!this._isStateValid(n))return!1;return!0}get(){return this._state.value}getRef(){return this.state}set(t){if(console.log(`status ${this._name} set to ${t}`),t=this._formatState(t),!this._isStateValid(t))throw`The state given to the set() method of Status instance '${this._name}' must a value in ${this.states}. Got: ${t}`;this._state.value=t}is(t){if(!this._isStateValid(t))throw`The state given to the is() method of Status instance '${this._name}' must a value in ${this.states}. Got: ${t}`;return this.get()==this._formatState(t)}isIn(t){if(!this._areStatesValid(t))throw`The states given to the isIn() method of Status instance '${this._name}' must be an array with values in ${this.states}. Got: ${t}`;for(const n of t)if(this.is(n))return!0;return!1}watch(t,n){let s=`The states given to the watch() method of Status instance '${this._name}' must be a string or an array with values in ${this.states}. Got: ${t}`;if(Array.isArray(t)){if(!this._areStatesValid(t))throw s;e.watch(this._state,()=>{this.isIn(t)&&n(this.get())})}else{if(!this._isStateValid(t))throw s;e.watch(this._state,()=>{this.is(t)&&n(this.get())})}}watchAny(t){this.watch(this.states,t)}}class M{constructor(t){this.contract=t,this.sources={},this.lastUpdateBlock=0}_buildSourceName(t,n){return`${t}:${n?n.toString():""}`}_generateDependentUUID(){return"xxxxxxxx".replace(/[xy]/g,function(t){var n=Math.random()*16|0,s=t=="x"?n:n&3|8;return s.toString(16)})}async update(t,n){const s=await a.dapp.provider.getBlockNumber();if(this.lastUpdateBlock<s){for(const[o,c]of Object.entries(this.sources)){const l=c.state.value;c.args?c.state.value=await this.contract[c.name](...c.args):c.state.value=await this.contract[c.name]();for(const h of Object.values(c.dependents))h&&h(c.state.value,l)}this.lastUpdateBlock=s}}add(t,n,s=null){const o=this._buildSourceName(t,n);let c=!1;Object.keys(this.sources).includes(o)||(this.sources[o]={name:t,args:n,state:e.ref(null),dependents:{}},c=!0);const l=this._generateDependentUUID();if(this.sources[o].dependents[l]=s||null,c){const h=this.sources[o].state.value;let u=null;n?u=this.contract[t](...n):u=this.contract[t](),u.then(f=>{this.sources[o].state.value=f,s(f,h)})}return l}remove(t,n,s){const o=this._buildSourceName(t,n);Object.keys(this.sources).includes(o)&&Object.keys(this.sources[o].dependents).includes(s)&&delete this.sources[o].dependents[s],Object.keys(this.sources[o].dependents).length===0&&delete this.sources[o]}getRef(t,n){const s=this._buildSourceName(t,n);return this.sources[s].state}}async function C(r=!1){if(!a.dapp.provider.isSafe.value){a.dapp.signer.status.set("NO_PROVIDER");return}if(a.dapp.provider.status.is("WRONG")){a.dapp.signer.status.set("WRONG_PROVIDER");return}if(!a.dapp.signer.status.is("CONNECTED"))try{const t=await a.dapp.provider.getSigner();await t.getAddress(),a.dapp.signer.proxy.setEthersObject(t),a.dapp.signer.status.set("CONNECTED")}catch{if(r===!0)a.dapp.signer.status.set("DISCONNECTED");else try{a.dapp.signer.status.set("REQUESTED"),await a.dapp.provider.send("eth_requestAccounts",[]);const n=await a.dapp.provider.getSigner();await n.getAddress(),a.dapp.signer.proxy.setEthersObject(n),a.dapp.signer.status.set("CONNECTED")}catch(n){n.code===4001?a.dapp.signer.status.set("REFUSED"):a.dapp.signer.status.set("ERROR")}}}function w(){a.dapp.signer.proxy.setEthersObject(null),a.dapp.signer.status.set("DISCONNECTED")}function De(r){for(var t=[];r&&r!==Object.prototype;)t.push.apply(t,Object.getOwnPropertyNames(r)),r=Object.getPrototypeOf(r);return t}class Be{constructor(t){this._parent=t}setEthersObject(t){this._parent._ethersObject=t&&e.markRaw(t),this.extendsEthersObject()}getEthersObject(){return this._parent._ethersObject}extendsEthersObject(){if(this._parent._ethersObject&&this._parent._extensionObject){const t=De(this._parent._extensionObject);for(const n of t)if(n!=="constructor")try{this._parent._ethersObject[n]=this._parent._extensionObject[n].bind(this._parent._ethersObject)}catch(s){if(s instanceof TypeError)this._parent._ethersObject[n]=this._parent._extensionObject[n];else throw s}}}}class R{constructor(t=null,n=null){return this._ethersObject=null,this._extensionObject=n,this.proxy=new Be(this),this.proxy.setEthersObject(t),new Proxy(this,{get:function(s,o,c){if(s._ethersObject&&s._ethersObject[o])try{return s._ethersObject[o].bind(s._ethersObject)}catch(l){if(l.message.includes(".bind is not a function"))return s._ethersObject[o];throw l}else if(s[o])return s[o]},set:function(s,o,c){return s._ethersObject&&s._ethersObject[o]?(s._ethersObject[o]=c,!0):(s[o]=c,!0)}})}}class Pe{}class F extends R{constructor(t=null){const n=new Pe;super(t,n),this.status=new g("provider",["DISCONNECTED","WRONG","ERROR","CONNECTED"]),this.isSafe=e.computed(()=>a.dapp.isSafe.value&&!this.status.isIn(["DISCONNECTED","ERROR"]))}onSafe(t){const n=e.getCurrentInstance();if(this.isSafe.value)t(n);else{const s=e.watch(this.isSafe,()=>{this.isSafe.value&&(t(n),s())})}}}class Ve{}class G extends R{constructor(t=null){const n=new Ve;super(t,n),this.status=new g("signer",["DISCONNECTED","REQUESTED","REFUSED","ERROR","NO_PROVIDER","WRONG_PROVIDER","CONNECTED"]),this.status.watch(["REFUSED","ERROR"],()=>{setTimeout(()=>{this.status.set("DISCONNECTED")},5e3)}),this.isSafe=e.computed(()=>a.dapp.provider.isSafe.value&&this.status.is("CONNECTED"))}onSafe(t){const n=e.getCurrentInstance();if(this.isSafe.value)t(n);else{const s=e.watch(this.isSafe,()=>{this.isSafe.value&&(t(n),s())})}}}class Te{_watch(t,n,s=null){return Object.keys(a.dapp._chainWatchers).includes(this.address)||(a.dapp._chainWatchers[this.address]=new M(this)),a.dapp._chainWatchers[this.address].add(t,n,s)}watch(t,n,s,o=null){const c=this._watch(t,n,s);return o?e.onUnmounted(()=>{a.dapp._chainWatchers[this.address].remove(t,n,c)},o):e.onUnmounted(()=>{a.dapp._chainWatchers[this.address].remove(t,n,c)}),a.dapp._chainWatchers[this.address].remove.bind(a.dapp._chainWatchers[this.address],t,n,c)}watchRef(t,n,s=null){const o=this._watch(t,n,null);return s?e.onUnmounted(()=>{a.dapp._chainWatchers[this.address].remove(t,n,o)},s):e.onUnmounted(()=>{a.dapp._chainWatchers[this.address].remove(t,n,o)}),a.dapp._chainWatchers[this.address].getRef(t,n)}}class S extends R{constructor(t,n){const s=new Te;super(n,s),this.status=new g(`contract:${t}`,["NO_PROVIDER","WRONG_PROVIDER","ERROR","INITIALIZED"]),this.isReadSafe=e.computed(()=>a.dapp.provider.isSafe.value&&this.status.is("INITIALIZED")),this.isWriteSafe=e.computed(()=>a.dapp.signer.isSafe.value&&this.status.is("INITIALIZED"))}onReadSafe(t){const n=e.getCurrentInstance();if(this.isReadSafe.value)t(n);else{const s=e.watch(this.isReadSafe,()=>{this.isReadSafe.value&&(t(n),s())})}}onWriteSafe(t){const n=e.getCurrentInstance();if(this.isWriteSafe.value)t(n);else{const s=e.watch(this.isWriteSafe,()=>{this.isWriteSafe.value&&(t(n),s())})}}}const I={providers:[{name:"Ethereum Mainnet",displayName:"Ethereum",chainId:1,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/ethereum.svg",currency:{name:"Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Etherscan",url:"https://etherscan.io/",standard:"EIP3091"},defaultRPC:"https://mainnet.infura.io/v3/"},{name:"Ropsten",displayName:"Ropsten (Ethereum Testnet)",chainId:3,type:"testnet",icon:null,currency:{name:"Ropsten Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Etherscan",url:"https://ropsten.etherscan.io/",standard:"EIP3091"},defaultRPC:"https://ropsten.infura.io/v3/"},{name:"Rinkeby",displayName:"Rinkeby (Ethereum Testnet)",chainId:4,type:"testnet",icon:null,currency:{name:"Rinkeby Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Etherscan",url:"https://rinkeby.etherscan.io/",standard:"EIP3091"},defaultRPC:"https://rinkeby.infura.io/v3/"},{name:"G\xF6rli",displayName:"G\xF6rli (Ethereum Testnet)",chainId:5,type:"testnet",icon:null,currency:{name:"G\xF6rli Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Etherscan",url:"https://goerli.etherscan.io/",standard:"EIP3091"},defaultRPC:"https://goerli.infura.io/v3/"},{name:"Optimism",chainId:10,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/optimism.svg",currency:{name:"Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Etherscan",url:"https://optimistic.etherscan.io/",standard:"EIP3091"},defaultRPC:"https://mainnet.optimism.io/"},{name:"Cronos Mainnet Beta",displayName:"Cronos",chainId:25,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/cronos.svg",currency:{name:"Cronos",symbol:"CRO",decimals:18},contracts:null,explorer:{name:"Cronos Explorer",url:"https://cronos.org/explorer",standard:"EIP3091"},defaultRPC:"https://evm.cronos.org"},{name:"Telos EVM Mainnet",displayName:"Telos",chainId:40,type:"mainnet",icon:null,currency:{name:"Telos",symbol:"TLOS",decimals:18},contracts:null,explorer:{name:"Teloscan",url:"https://teloscan.io/",standard:"EIP3091"},defaultRPC:"https://mainnet.telos.net/evm"},{name:"Binance Smart Chain Mainnet",displayName:"BSC",chainId:56,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/bsc.svg",currency:{name:"Binance Chain Native Token",symbol:"BNB",decimals:18},contracts:null,explorer:{name:"Bscscan",url:"https://bscscan.com/",standard:"EIP3091"},defaultRPC:"https://bsc-dataseed1.binance.org/"},{name:"Gnosis Chain",displayName:"Gnosis",chainId:100,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/gnosis.svg",currency:{name:"xDAI",symbol:"xDAI",decimals:18},contracts:null,explorer:{name:"Blockscout",url:"https://blockscout.com/xdai/mainnet/",standard:"EIP3091"},defaultRPC:"https://rpc.gnosischain.com"},{name:"Fuse Mainnet",displayName:"Fuse",chainId:122,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/fuse.svg",currency:{name:"Fuse",symbol:"FUSE",decimals:18},contracts:null,explorer:{name:"Fuse Explorer",url:"https://explorer.fuse.io/",standard:"EIP3091"},defaultRPC:"https://rpc.fuse.io"},{name:"Huobi ECO Chain Mainnet",displayName:"HECO",chainId:128,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/heco.svg",currency:{name:"Huobi ECO Chain Native Token",symbol:"HT",decimals:18},contracts:null,explorer:{name:"Hecoinfo",url:"https://hecoinfo.com",standard:"EIP3091"},defaultRPC:"https://http-mainnet.hecochain.com"},{name:"Polygon Mainnet",displayName:"Polygon",chainId:137,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/polygon.svg",currency:{name:"MATIC",symbol:"MATIC",decimals:18},contracts:null,explorer:{name:"Polygonscan",url:"https://polygonscan.com/",standard:"EIP3091"},defaultRPC:"https://polygon-rpc.com/"},{name:"Fantom Opera",displayName:"Fantom",chainId:250,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/fantom.svg",currency:{name:"Fantom",symbol:"FTM",decimals:18},contracts:null,explorer:{name:"Ftmscan",url:"https://ftmscan.com/",standard:"EIP3091"},defaultRPC:"https://rpc.ftm.tools"},{name:"Metis Andromeda Mainnet",displayName:"Metis",chainId:1088,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/metis.svg",currency:{name:"Metis",symbol:"METIS",decimals:18},contracts:null,explorer:{name:"Metis Explorer",url:"https://andromeda-explorer.metis.io",standard:"EIP3091"},defaultRPC:"https://andromeda.metis.io/?owner=1088"},{name:"Moonbeam",chainId:1284,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/moonbeam.svg",currency:{name:"Glimmer",symbol:"GLMR",decimals:18},contracts:null,explorer:{name:"Moonscan",url:"https://moonbeam.moonscan.io",standard:"EIP3091"},defaultRPC:"https://rpc.api.moonbeam.network"},{name:"Moonriver",chainId:1285,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/moonriver.svg",currency:{name:"Moonriver",symbol:"MOVR",decimals:18},contracts:null,explorer:{name:"Moonscan",url:"https://moonriver.moonscan.io/",standard:"EIP3091"},defaultRPC:"https://rpc.api.moonriver.moonbeam.network"},{name:"Klaytn Mainnet Cypress",displayName:"Klaytn",chainId:8217,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/klaytn.svg",currency:{name:"KLAY",symbol:"KLAY",decimals:18},contracts:null,explorer:{name:"Klaytnscope",url:"https://scope.klaytn.com",standard:"EIP3091"},defaultRPC:"https://public-node-api.klaytnapi.com/v1/cypress"},{name:"Hardhat",displayName:"Hardhat",chainId:31337,type:"testnet",icon:null,currency:{name:"GoChain Coin",symbol:"GO",decimals:18},contracts:null,explorer:null,defaultRPC:"http://127.0.0.1:8545/"},{name:"Arbitrum One",displayName:"Arbitrum",chainId:42161,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/arbitrum.svg",currency:{name:"Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Arbiscan",url:"https://arbiscan.io/",standard:"EIP3091"},defaultRPC:"https://arbitrum-mainnet.infura.io/v3/"},{name:"Celo Mainnet",displayName:"Celo",chainId:42220,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/celo.svg",currency:{name:"CELO",symbol:"CELO",decimals:18},contracts:null,explorer:{name:"Celo Explorer",url:"https://explorer.celo.org/",standard:"EIP3091"},defaultRPC:"https://forno.celo.org"},{name:"Emerald Paratime Mainnet",displayName:"Emerald",chainId:42262,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/emerald.svg",currency:{name:"Emerald Rose",symbol:"ROSE",decimals:18},contracts:null,explorer:{name:"Emerald Explorer",url:"https://explorer.emerald.oasis.dev/",standard:"EIP3091"},defaultRPC:"https://emerald.oasis.dev"},{name:"Avalanche C-Chain",displayName:"Avalanche",chainId:43114,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/avalanche.svg",currency:{name:"Avalanche",symbol:"AVAX",decimals:18},contracts:null,explorer:{name:"Snowtrace",url:"https://snowtrace.io/",standard:"EIP3091"},defaultRPC:"https://api.avax.network/ext/bc/C/rpc"},{name:"Aurora Mainnet",displayName:"Aurora",chainId:1313161554,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/aurora.svg",currency:{name:"Ether",symbol:"ETH",decimals:18},contracts:null,explorer:{name:"Aurorascan",url:"https://aurorascan.dev",standard:"EIP3091"},defaultRPC:"https://mainnet.aurora.dev"},{name:"Harmony Mainnet Shard 0",displayName:"Harmony",chainId:16666e5,type:"mainnet",icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/harmony.svg",currency:{name:"ONE",symbol:"ONE",decimals:18},contracts:null,explorer:{name:"Harmony Block Explorer",url:"https://explorer.harmony.one",standard:"EIP3091"},defaultRPC:"https://api.harmony.one"}],defaults:{providers:{icon:"https://storageapi.fleek.co/f3e0e6d9-57d8-48b7-b4ef-b7bbde26978c-bucket/vuethers/networks/unknown.svg"}}};class L{constructor(t=null){if(this.providers=[],t&&t.providers){for(const n of t.providers)if(n.chainId){const s=I.providers.find(c=>c.chainId===n.chainId),o=k({...s},{...n});o.available!==!1&&(o.available=!0),o.displayName||(o.displayName=o.name),this.providers.push(o)}}this.providers.getCurrent=this._getCurrentProvider,this.providers.getDefault=this._getDefaultProvider,this.providers.getAvailable=this._getAvailableProviders,this.providers.getAll=this._getAllProviders,this.defaults={},t&&t.defaults?this.defaults=k({...I.defaults},{...t.defaults}):this.defaults=I.defaults}async _getCurrentProvider(){const t=await a.dapp.provider.getNetwork().then(n=>n.chainId);return a.dapp.config.providers.find(n=>n.chainId===t)}_getDefaultProvider(){return a.dapp.config.providers.find(t=>t.default===!0)}async _getAvailableProviders(){const t=await this.getCurrent();return a.dapp.config.providers.filter(n=>n.available&&n!==t)}_getAllProviders(){return a.dapp.config.providers}}class D{constructor(t){this.func=t,this.constant=!1,this.status=new g("tx",["UNSENT","SENT","ERROR","SUCCESS"]),this.status.watch(["ERROR","SUCCESS"],()=>{setTimeout(()=>{this.status.set("UNSENT")},5e3)}),this.data=null,this.error=null,this.call=null}send(t=[],n={}){t?Array.isArray(t)?this.call=this.func(...t,n):this.call=this.func(t,n):this.call=this.func(n),this.status.set("SENT"),this.constant?this.call.then(s=>{this.data=s,this.status.set("SUCCESS")}).catch(s=>{this.error=s,this.status.set("ERROR")}):this.call.then(s=>(console.log("TX"),console.log(s),s.wait())).then(s=>{this.data=s,this.status.set("SUCCESS")}).catch(s=>{this.error=s,this.status.set("ERROR")})}}function O(r){return r&&typeof r=="object"&&!Array.isArray(r)}function k(r,...t){if(!t.length)return r;const n=t.shift();if(O(r)&&O(n))for(const s in n)O(n[s])?(r[s]||Object.assign(r,{[s]:{}}),k(r[s],n[s])):Object.assign(r,{[s]:n[s]});return k(r,...t)}function H(r){const t=r.split(" ");for(let n=0;n<t.length;n++)t[n]=t[n][0].toUpperCase()+t[n].substring(1);return t.join(" ")}a.dapp=null;function $e(r,t){const n=t.config,s=t.start;Promise.resolve().then(()=>We).then(o=>{a.dapp=new o.Dapp(n),r.config.globalProperties.dapp=a.dapp,Promise.resolve().then(()=>He).then(async function(l){l.initComponents(r),s(),await l.initProvider(),await l.initSigner(),await l.initContracts(),await l.initWatchers(),a.dapp.status.set("SAFE")})})}class je{constructor(t){this.status=new g("contracts",["NO_PROVIDER","WRONG_PROVIDER","ERROR","INITIALIZED"]);for(const n of t.config.providers)if(n.contracts)for(const[s,o]of Object.entries(n.contracts))this[s]=new S(s);this.areReadSafe=e.computed(()=>t.provider.isSafe.value&&this.status.is("INITIALIZED")),this.areWriteSafe=e.computed(()=>t.signer.isSafe.value&&this.status.is("INITIALIZED"))}add(t,n,s){if(Object.keys(this).includes(t)){if(!this[t]instanceof S)throw`You cannot add a new contract called '${t}', this name is reserved by Vuethers.`;if(a.dapp.signer.isSafe.value)this[t].proxy.setEthersObject(new E.ethers.Contract(n,s,a.dapp.signer.proxy.getEthersObject()));else if(a.dapp.provider.isSafe.value)this[t].proxy.setEthersObject(new E.ethers.Contract(n,s,a.dapp.provider.proxy.getEthersObject()));else throw"A contract is trying to be added from dapp.contract.add() but neither provider nor signer are available."}else if(a.dapp.signer.isSafe.value)this[t]=new S(new E.ethers.Contract(n,s,a.dapp.signer.proxy.getEthersObject()));else if(a.dapp.provider.isSafe.value)this[t]=new S(new E.ethers.Contract(n,s,a.dapp.provider.proxy.getEthersObject()));else throw"A contract is trying to be added from dapp.contract.add() but neither provider nor signer are available."}remove(t){Object.keys(this).includes(t)&&delete this[t]}getAll(){const t={};for(const[n,s]of Object.entries(this))s instanceof S&&(t[n]=s);return t}onReadSafe(t){const n=e.getCurrentInstance();if(this.areReadSafe.value)t(n);else{const s=e.watch(this.areReadSafe,()=>{this.areReadSafe.value&&(t(n),s())})}}onWriteSafe(t){const n=e.getCurrentInstance();if(this.areWriteSafe.value)t(n);else{const s=e.watch(this.areWriteSafe,()=>{this.areWriteSafe.value&&(t(n),s())})}}}class Ae{constructor(t){this.config=new L(t),this.status=new g("dapp",["UNSAFE","SAFE"]),this.provider=new F,this.signer=new G,this.contracts=new je(this),this.isSafe=e.computed(()=>this.status.is("SAFE")),this._chainWatchers={}}onSafe(t){const n=e.getCurrentInstance();if(this.isSafe.value)t(n);else{const s=e.watch(this.isSafe,()=>{this.isSafe.value&&(t(n),s())})}}}const We=Object.freeze(Object.defineProperty({__proto__:null,Dapp:Ae},Symbol.toStringTag,{value:"Module"}));async function Ue(){try{a.dapp.provider.proxy.setEthersObject(new E.ethers.providers.Web3Provider(window.ethereum,"any"))}catch(r){console.log(r),a.dapp.provider.status.set("ERROR")}if(a.dapp.provider._ethersObject){const r=await a.dapp.provider.getNetwork();let t=await a.dapp.config.providers.find(n=>n.chainId===r.chainId);if(t)a.dapp.provider.status.set("CONNECTED");else if(a.dapp.provider.status.set("WRONG"),t=a.dapp.config.providers.getAll().find(n=>n.chainId===r.chainId),!t){const n={name:r.name,displayName:H(r.name),chainId:r.chainId};a.dapp.config.providers.append(n)}a.dapp.provider.on("network",(n,s)=>{s&&s!==n&&window.location.reload()}),a.dapp.provider.on("error",()=>{a.dapp.provider.status.set("ERROR")}),t&&t.pollingInterval&&(a.dapp.provider.pollingInterval=t.pollingInterval)}else{const r=a.dapp.config.providers.getDefault();r&&r.defaultRPC?(a.dapp.provider.proxy.setEthersObject(new E.ethers.providers.JsonRpcProvider(r.defaultRPC)),a.dapp.provider.status.set("CONNECTED")):a.dapp.provider.status.set("DISCONNECTED")}}async function Me(){a.dapp.provider.onSafe(async function(){await C(!0)})}async function Fe(){a.dapp.provider.onSafe(async function(){if(a.dapp.provider.status.is("WRONG")){for(const[n,s]of a.dapp.contracts.getAll())s.status.set("WRONG_NETWORK");a.dapp.contracts.status.set("WRONG_NETWORK");return}const r=await a.dapp.config.providers.getCurrent(),t=[];for(const[n,s]of Object.entries(r.contracts))a.dapp.contracts.add(n,s.address,s.abi),t.push(n);for(const[n,s]of Object.entries(a.dapp.contracts.getAll()))t.includes(n)?s.status.set("INITIALIZED"):s.status.set("WRONG_NETWORK");e.watch([a.dapp.signer.isSafe],(n,s)=>{if(console.log("Refresh contracts !"),n!==s)for(const o of t){const c=o,l=a.dapp.contracts[o].address,h=a.dapp.contracts[o].interface.format("json");a.dapp.contracts[o].proxy.setEthersObject(null);try{a.dapp.contracts.add(c,l,h)}catch(u){console.log(u),a.dapp.contracts.status.set("ERROR");break}}}),a.dapp.contracts.status.set("INITIALIZED")})}async function Ge(){a.dapp.provider.onSafe(()=>{a.dapp.provider.on("block",async function(r){const t=await a.dapp.provider.getBlockWithTransactions(r);for(const n of t.transactions)Object.keys(a.dapp._chainWatchers).includes(n.to)&&await a.dapp._chainWatchers[n.to].update(),a.dapp.signer.status.is("CONNECTED")&&(await a.dapp.signer.getAddress(),n.from)})})}async function Le(r){r.component("OnDappSafe",V),r.component("OnProviderSafe",T),r.component("OnSignerSafe",$),r.component("OnContractsReadSafe",j),r.component("OnContractsWriteSafe",A),r.component("OnContractReadSafe",W),r.component("OnContractWriteSafe",U)}const He=Object.freeze(Object.defineProperty({__proto__:null,initProvider:Ue,initSigner:Me,initContracts:Fe,initWatchers:Ge,initComponents:Le},Symbol.toStringTag,{value:"Module"}));return a.ChainWatcher=M,a.ConnectWalletButton=X,a.ContractInteractor=ue,a.DebugBar=Ne,a.EthersContractProxy=S,a.EthersProviderProxy=F,a.EthersSignerProxy=G,a.OnContractReadSafe=W,a.OnContractWriteSafe=U,a.OnContractsReadSafe=j,a.OnContractsWriteSafe=A,a.OnDappSafe=V,a.OnProviderSafe=T,a.OnSignerSafe=$,a.SelectNetworkDropdown=ge,a.Status=g,a.Transact=Ie,a.Transaction=D,a.VuethersConfig=L,a.capitalizeWords=H,a.connectWallet=C,a.deepMerge=k,a.disconnectWallet=w,a.initVuethers=$e,a.isObject=O,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),a}({},Ethers,Vue);
